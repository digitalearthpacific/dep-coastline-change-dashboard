@use '../../styles/mixins' as *;

.mapContainer {
  height: 100%;
  transition: width 0.3s ease-in-out;
  position: relative;

  &.withResultPanel {
    width: 50%;
  }

  &.fullWidth {
    width: 100%;
  }
}

/* ===== MAPLIBRE ZOOM CONTROLS ===== */
:root {
  --navigation-control-margin-right: 24px;
  --navigation-control-margin-bottom: 106px;

  @include mobile-only {
    --navigation-control-margin-right: 16px;
    --navigation-control-margin-bottom: 96px;
  }
}

:global(.maplibregl-ctrl-zoom-in),
:global(.maplibregl-ctrl-zoom-out) {
  width: var(--space-6, 32px) !important;
  height: var(--space-6, 32px) !important;
  position: relative;
}

/* Desktop-only tooltips */
@include desktop-only {
  :global(.maplibregl-ctrl-zoom-in),
  :global(.maplibregl-ctrl-zoom-out) {
    /* Tooltip arrow */
    &:hover::before {
      content: '';
      position: absolute;
      right: 100%;
      top: 50%;
      transform: translateY(-50%);
      margin-right: 0;
      border: 6px solid transparent;
      border-left-color: var(--gray-12);
      z-index: 1000;
      pointer-events: none;
    }

    /* Tooltip content */
    &:hover::after {
      position: absolute;
      right: 100%;
      top: 50%;
      transform: translateY(-50%);
      background: var(--gray-12);
      color: var(--gray-1);
      padding: var(--space-1, 0.25rem) var(--space-2, 0.5rem);
      border-radius: var(--radius-2, 4px);
      font-size: var(--font-size-xs, 0.75rem);
      white-space: nowrap;
      margin-right: 11px;
      z-index: 999;
      pointer-events: none;
    }
  }

  /* Tooltip text content */
  :global(.maplibregl-ctrl-zoom-in):hover::after {
    content: 'Zoom In';
  }

  :global(.maplibregl-ctrl-zoom-out):hover::after {
    content: 'Zoom Out';
  }
}

/* ===== CUSTOM MAP TOOLS ===== */
.customMapTools {
  position: absolute;
  right: var(--space-5, 24px);
  bottom: var(--space-5, 24px);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2, 8px);

  @include mobile-only {
    top: 82px;
    bottom: auto;
    right: var(--space-4, 16px);
  }

  button {
    @include button-styles;
  }

  .baseMapPopup {
    position: absolute;
    right: 40px;
    bottom: 0px;
    display: flex;
    flex-direction: column;
    background: var(--white, #fff);
    border-radius: var(--radius-4, 8px);
    border: 1px solid var(--grey-a6, #00000026);
    padding: var(--space-3, 12px);
    gap: var(--space-4, 16px);
    z-index: 1000;

    .popupSection {
      display: flex;
      flex-direction: column;
      gap: var(--space-2, 8px);
    }

    .mapTypeTitle {
      font-size: var(--font-size-2, 14px);
      font-weight: 700;
      color: var(--gray-12, #202020);
    }

    .mapTypeContainer {
      display: flex;
      gap: var(--space-2, 8px);
    }

    @include mobile-only {
      right: 0;
      bottom: -223px;
    }

    .baseMapButton {
      border: none;
      background: none;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-1, 4px);
      border-radius: var(--radius-2, 4px);
      padding: 0;
      font-family: var(--font-family-primary);
      box-shadow: none;
      color: var(--gray-12, #202020);

      img {
        width: var(--space-8, 48px);
        height: var(--space-8, 48px);
        border-radius: var(--radius-2, 4px);
        object-fit: cover;
      }

      &.selected img {
        outline: 2px solid var(--blue-10, #008ac5);
        border-radius: var(--radius-2, 4px);
      }
    }

    .checkboxButton {
      --accent-indicator: var(--blue-9, #008ac5);
      --accent-contrast: var(--white, #fff);
      border-radius: var(--radius-1, 3px);
    }
  }
}

.exitFullscreenContainer {
  position: absolute;
  top: var(--space-4, 16px);
  right: var(--space-4, 16px);
  z-index: 1000;

  @include mobile-only {
    top: var(--space-3, 12px);
    right: var(--space-3, 12px);
  }

  button {
    @include button-styles;
  }
}

.mapLegend {
  position: absolute;
  bottom: 40px;
  left: var(--space-5, 24px);
  background: var(--white, #fff);
  border-radius: var(--radius-4, 8px);
  padding: var(--space-3, 16px);
  box-shadow:
    0 12px 32px -16px var(--gray-a5, rgba(0, 0, 0, 0.12)),
    0 12px 60px 0 var(--black-a3, rgba(0, 0, 0, 0.15));
  z-index: 1000;

  @include mobile-only {
    top: 10px;
    bottom: auto;
    left: var(--space-4, 16px);
  }
}

.legendTitle {
  font-size: var(--font-size-2, 14px);
  font-weight: 700;
  color: var(--gray-12, #202020);
}

.legendSubtitle {
  font-size: var(--font-size-1, 12px);
  font-weight: 400;
  color: var(--gray-11, #646464);
  margin-bottom: var(--space-2, 8px);
}

.legendItems {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.legendItem {
  display: flex;
  align-items: center;
  gap: 8px;
}

.legendCircle {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  flex-shrink: 0;

  @include mobile-only {
    width: 12px;
    height: 12px;
  }

  &.highChange {
    background-color: var(--error-a8, rgba(210, 0, 5, 0.44)); // Red/coral color
  }

  &.moderateChange {
    background-color: var(--warning-a9, rgba(255, 179, 0, 0.76)); // Orange/yellow color
  }

  &.lowChange {
    background-color: var(--success-a8, rgba(0, 146, 75, 0.64)); // Green color
  }
}

.legendText {
  font-size: var(--font-size-1, 12px);
  color: var(--gray-a12, rgba(0, 0, 0, 0.87));
  font-weight: 500;
}
